<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- bing验证 -->
    <meta name="msvalidate.01" content="A572ACFFCAD037CBA75681AC693B74F0" />
    <link rel="stylesheet" href="./css/font.css">
    <link rel="stylesheet" href="./css/index.css">
    <title>墨枢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            /* 防止内容高度变化导致的布局重排 */
        }
        .header {
            padding: 1rem 0;
            width: 100%;
            margin: auto;
            text-align: center;
        }

        .header .title {
            font-weight: bold;
            line-height: 1;
        }

        .app-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
            gap: 1rem;
            align-items: center;
        }

        .app {
            background: white;
            padding: 0.5rem;
            border-radius: 8px;
            text-align: center;
            border: 2px dashed rgb(133, 133, 133);
            text-decoration: none;
            color: black;
        }

        .app .avater {
            margin-bottom: 0.5rem;
        }

        .main {
            padding: 3rem;
        }

        .message {
            margin-bottom: 2rem;
        }

        .mask {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
        }
    </style>
</head>

<body>
    <header class="header">
        <div class="title font-douyinsans">墨枢</div>
        <div class="font-yufanxinyu">MOSHU</div>
    </header>
    <main class="main">
        <div class="message">
            <h1>...</h1>
            <p class="tip">请确保在浏览器设置中启用JavaScript</p>
        </div>
        <div class="app-list">
            <a class="app" href="./pages/Clock.html">
                <div class="avater">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24">
                        <g fill="none" stroke="#000000" stroke-linecap="round" stroke-width="1.5">
                            <path stroke-linejoin="round" d="M12 8v4l2.5 2.5" />
                            <path
                                d="M22 12c0 4.714 0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12s0-7.071 1.464-8.536C4.93 2 7.286 2 12 2s7.071 0 8.535 1.464c.974.974 1.3 2.343 1.41 4.536" />
                        </g>
                    </svg>
                </div>
                <div class="title">时钟</div>
            </a>
            <a class="app" href="./pages/timer.html">
                <div class="avater">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24">
                        <g fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round"
                            stroke-width="1.5">
                            <path
                                d="M17.031.75c1.437 2.873-2.9 3.881-.75 6.75M12.531.75c1.437 2.873-2.9 3.881-.75 6.75M8.031.75c1.437 2.873-2.9 3.881-.75 6.75M.75 12.75c0 .796 1.185 1.559 3.295 2.121s4.971.879 7.955.879s5.845-.316 7.955-.879s3.295-1.325 3.295-2.121s-1.185-1.559-3.295-2.121S14.984 9.75 12 9.75s-5.845.316-7.955.879S.75 11.954.75 12.75" />
                            <path d="M23.25 12.75c0 5.8-5.037 10.5-11.25 10.5S.75 18.549.75 12.75" />
                        </g>
                    </svg>
                </div>
                <div class="title">盖泡面</div>
            </a>
            <a class="app" href="https://r.qq.com">
                <div class="avater"><svg t="1755928290747" class="icon" viewBox="0 0 1024 1024" version="1.1"
                        xmlns="http://www.w3.org/2000/svg" p-id="3807" width="32" height="32">
                        <path
                            d="M204.078 0h615.845q202.07 0 202.07 202.07v615.845q0 202.07-202.07 202.07H204.077q-202.07 0-202.07-202.07V202.069Q2.008 0 204.078 0z"
                            fill="#06679a" p-id="3808" data-spm-anchor-id="a313x.search_index.0.i18.59253a81VFpG5o"
                            class="selected"></path>
                        <path
                            d="M616.087 869.276a106.657 106.657 0 0 0-102.641 77.663 106.657 106.657 0 0 0-102.641-77.663H7.63A202.11 202.11 0 0 0 204.077 1024h615.846a202.11 202.11 0 0 0 196.447-154.724z m255.437-128.14c-44.654 44.172-99.026 54.934-157.816 35.217-19.356-6.506-35.258-8.032-52.204 3.212a73.326 73.326 0 0 1-11.324 3.775c15.46-26.865 4.015-43.65-9.036-62.685-28.993-42.285-23.09-96.738 11.405-136.051 56.22-64.251 166.731-64.251 223.112 0 40.96 46.662 40.076 112.64-4.137 156.531z"
                            fill="#FFFFFF" p-id="3809"></path>
                        <path
                            d="M818.96 611.187a20.078 20.078 0 0 0-20.883 19.276 19.516 19.516 0 0 0 18.473 21.444 20.078 20.078 0 0 0 22.006-18.03 20.68 20.68 0 0 0-19.597-22.69z m-108.906 0a20.078 20.078 0 0 0-20.079 22.207 19.556 19.556 0 0 0 21.404 18.472 20.078 20.078 0 0 0 19.275-20.921 20.922 20.922 0 0 0-20.6-19.758z"
                            fill="#4496D3" p-id="3810"></path>
                    </svg></div>
                <div class="title">微信读书</div>
            </a>
            <a class="app" href="./pages/Snake.html">
                <div class="avater">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 16 16">
                        <g fill="#000000">
                            <path d="M8 3.5a.5.5 0 1 1-1 0a.5.5 0 0 1 1 0" />
                            <path fill-rule="evenodd"
                                d="M5.5 1a2.5 2.5 0 0 0-2.086 3.879L2.293 6H.5v1H2v1.5h1V6.707l1.121-1.121c.396.262.87.414 1.379.414H7v2H6a2 2 0 0 0-2 2a2 2 0 1 0 0 4h9a2 2 0 1 0 0-4a2 2 0 0 0-2-2V4.5A3.5 3.5 0 0 0 7.5 1zM4 3.5A1.5 1.5 0 0 1 5.5 2h2A2.5 2.5 0 0 1 10 4.5v4l.5.5h.5a1 1 0 0 1 1 1v1h1a1 1 0 1 1 0 2H4a1 1 0 1 1 0-2h1v-1a1 1 0 0 1 1-1h1.5l.5-.5v-3L7.5 5h-2A1.5 1.5 0 0 1 4 3.5"
                                clip-rule="evenodd" />
                        </g>
                    </svg>
                </div>
                <div class="title">贪吃蛇</div>
            </a>
            <a class="app" href="javascript:void(0);" onclick="setting()">
                <div class="avater">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24">
                        <g fill="none" stroke="#000000" stroke-width="1.5">
                            <circle cx="12" cy="12" r="3" />
                            <path
                                d="M13.765 2.152C13.398 2 12.932 2 12 2s-1.398 0-1.765.152a2 2 0 0 0-1.083 1.083c-.092.223-.129.484-.143.863a1.62 1.62 0 0 1-.79 1.353a1.62 1.62 0 0 1-1.567.008c-.336-.178-.579-.276-.82-.308a2 2 0 0 0-1.478.396C4.04 5.79 3.806 6.193 3.34 7s-.7 1.21-.751 1.605a2 2 0 0 0 .396 1.479c.148.192.355.353.676.555c.473.297.777.803.777 1.361s-.304 1.064-.777 1.36c-.321.203-.529.364-.676.556a2 2 0 0 0-.396 1.479c.052.394.285.798.75 1.605c.467.807.7 1.21 1.015 1.453a2 2 0 0 0 1.479.396c.24-.032.483-.13.819-.308a1.62 1.62 0 0 1 1.567.008c.483.28.77.795.79 1.353c.014.38.05.64.143.863a2 2 0 0 0 1.083 1.083C10.602 22 11.068 22 12 22s1.398 0 1.765-.152a2 2 0 0 0 1.083-1.083c.092-.223.129-.483.143-.863c.02-.558.307-1.074.79-1.353a1.62 1.62 0 0 1 1.567-.008c.336.178.579.276.819.308a2 2 0 0 0 1.479-.396c.315-.242.548-.646 1.014-1.453s.7-1.21.751-1.605a2 2 0 0 0-.396-1.479c-.148-.192-.355-.353-.676-.555A1.62 1.62 0 0 1 19.562 12c0-.558.304-1.064.777-1.36c.321-.203.529-.364.676-.556a2 2 0 0 0 .396-1.479c-.052-.394-.285-.798-.75-1.605c-.467-.807-.7-1.21-1.015-1.453a2 2 0 0 0-1.479-.396c-.24.032-.483.13-.82.308a1.62 1.62 0 0 1-1.566-.008a1.62 1.62 0 0 1-.79-1.353c-.014-.38-.05-.64-.143-.863a2 2 0 0 0-1.083-1.083Z" />
                        </g>
                    </svg>
                </div>
                <div class="title">设置</div>
            </a>
        </div>
    </main>
    <div class="mask" onclick="hideLog()"></div>
    <div class="log">
        <div class="log-header">
            <div class="log-title">标题</div>
            <div class="log-close" onclick="hideLog()">x</div>
        </div>
        <div class="log-content">请输入内容</div>
        <div class="log-body">
            <textarea name="" id="" placeholder="请输入欢迎语"></textarea>
            <div class="log-submit-container">
                <button class="log-submit" onclick="resetLog()">恢复默认欢迎语</button>
                <button class="log-submit" onclick="submitLog()">更改欢迎语</button>
            </div>
        </div>
        <div class="log-body">
            <button id="setLogo" class="log-submit" onclick="setLogo()">隐藏Logo</button>
        </div>
        <div class="log-body">
            <p>设置字体</p>
            <select id="fontSelect" class="log-submit" onchange="setFont()">
                <option value="font-default">默认</option>
                <option value="font-zhisong">霞鹜新致宋</option>
            </select>
        </div>
        <div class="log-body">
            <a class="log-submit" href="./pages/suggest.html">建议反馈</a>
        </div>
    </div>

</body>
<script>
    let config = {
        message: "我们是<br>沙沙作响的叶片<br>以这声音回应着暴风雨.",
        logo: true,
        font: "font-default"
    }
    const tip = document.querySelector('.tip');
    var title = document.querySelector('.message h1');
    function init() {
        tip.style.display = 'none';
        // 获取用户自定义配置
        let userConfig = localStorage.getItem('config');
        if (userConfig) {
            try {
                userConfig = JSON.parse(userConfig);
                config = { ...config, ...userConfig };
                title.innerHTML = config.message;
                title.className = config.font;
                if (!config.logo) {
                    document.querySelector('.header').style.display = 'none';
                    document.querySelector('#setLogo').innerHTML = '显示Logo';
                }
            } catch (e) {
                console.error('配置解析失败:', e);
            }
        } else {
            title.innerHTML = config.message;
        }
    }
    function setting() {
        showLog({ title: "设置", content: "欢迎使用墨枢！<br>在这里你可以自定义欢迎语和Logo的显示与隐藏。" });
        document.getElementById('fontSelect').value = config.font;
    }

    function submitLog() {
        let log = document.querySelector('textarea').value;
        log = escapeHtml(log); // 先转义危险字符
        log = fixText(log); // 再替换换行
        if (log) {
            config.message = log;
            localStorage.setItem('config', JSON.stringify(config));
            document.querySelector('.message h1').innerHTML = log;
            hideLog();
        } else {
            showLog({ title: "提示" });
        }
    }

    function resetLog() {
        config.message = "我们是<br>沙沙作响的叶片<br>以这声音回应着暴风雨.";
        localStorage.setItem('config', JSON.stringify(config));
        document.querySelector('.message h1').innerHTML = config.message;
        hideLog();
    }

    function fixText(text) {
        text = text || '';
        return text.replace(/\r?\n/g, "<br/>"); // 匹配 \n 或 \r\n，替换为 <br/>
    }

    function showLog({ title = "提示", content = "欢迎使用墨枢！<br>在这里你可以自定义欢迎语和Logo的显示与隐藏。" }) {
        document.querySelector('.mask').style.display = 'block';
        document.querySelector('.log').style.display = 'flex';
        document.querySelector('.log-content').innerHTML = content;
        document.querySelector('.log-title').innerHTML = title;

    }
    function hideLog() {
        document.querySelector('.mask').style.display = 'none';
        document.querySelector('.log').style.display = 'none';
    }
    function setLogo() {
        config.logo = !config.logo;
        localStorage.setItem('config', JSON.stringify(config));
        if (config.logo) {
            document.querySelector('.header').style.display = 'block';
            document.querySelector('#setLogo').innerHTML = '隐藏Logo';
        } else {
            document.querySelector('.header').style.display = 'none';
            document.querySelector('#setLogo').innerHTML = '显示Logo';
        }
        hideLog();
    }
    function setFont() {
        var selectedFont = document.getElementById('fontSelect').value;
        title.className = selectedFont;
        config.font = selectedFont;
        localStorage.setItem('config', JSON.stringify(config));
        hideLog();
    }

    // 转义函数（转义除<br>外的HTML标签）
    function escapeHtml(unsafe) {
        return unsafe.replace(/[&<"'>]/g, function (match) {
            switch (match) {
                case '&': return '&amp;';
                case '<': return '&lt;';
                case '>': return '&gt;';
                case '"': return '&quot;';
                case "'": return '&#039;';
                default: return match;
            }
        });
    }
    init()
</script>

</html>
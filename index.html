<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>墨枢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            /* 防止内容高度变化导致的布局重排 */
        }

        .header {
            width: 100%;
            height: 8vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .header .title {
            font-weight: bold;
            line-height: 1;
        }

        .app-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            align-items: center;
        }

        .app {
            display: flex;
            flex-direction: column;
            background: white;
            padding: 0.8rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid black;
            text-decoration: none;
            color: black;
        }

        .app .avater {
            margin-bottom: 0.5rem;
        }

        .main {
            padding: 3rem;
        }

        .message {
            margin-bottom: 2rem;
        }

        .mask {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
        }

        .log {
            width: fit-content;
            /* 宽度自适应内容 */
            min-width: 300px;
            /* 最小宽度 */
            max-width: 95vw;
            /* 最大宽度不超过屏幕的95% */
            position: fixed;
            /* 固定定位 */
            top: 50%;
            /* 顶部距离视口顶部50% */
            left: 50%;
            /* 左侧距离视口左侧50% */
            transform: translate(-50%, -50%);
            /* 自身向左上偏移50%宽度/高度，实现居中 */
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 2px solid black;
            display: none;
            /* 默认隐藏 */
            flex-direction: column;
            align-items: center;
            /* 内部元素水平居中 */
            z-index: 1000;
            /* 确保在最上层（可选，避免被其他元素遮挡） */
        }

        .log textarea {
            min-height: 80px;
            width: 100%;
            padding: 0.5rem;
            height: fit-content;
            border: 2px solid black;
            border-radius: 4px;
        }

        .log-header {
            width: 100%;
            display: flex;
            border-bottom: 1px solid black;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .log-body {
            padding: 0.5rem 0;
            border-bottom: 1px solid black;
            width: 100%;
        }

        .log-submit-container {
            display: flex;
            width: 100%;
            justify-content: space-between;
        }

        .log-submit-container button {
            margin: 0.5rem;
        }

        .log .log-submit {
            width: 100%;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            background-color: white;
            border: 2px solid black;
            cursor: pointer;
            margin: 0.5rem 0;
        }
    </style>
</head>

<body>
    <header class="header">
        <div class="title">墨枢</div>
        <!-- <div>Kindle工具集</div> -->
    </header>
    <main class="main">
        <div class="message">
            <h1>...</h1>
        </div>
        <div class="app-list">
            <a class="app" href="https://lecepin.github.io/kindle-time/">
                <div class="avater">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 1024 1024">
                        <path fill="#000000"
                            d="M512 1024q-139 0-257-68.5T68.5 769T0 512t68.5-257T255 68.5T512 0t257 68.5T955.5 255t68.5 257t-68.5 257T769 955.5T512 1024m256-576H576V192q0-27-19-45.5T511.5 128t-45 18.5T448 192v320q0 27 18.5 45.5T512 576h256q26 0 45-19t19-45.5t-18.5-45T768 448" />
                    </svg>
                </div>
                <div class="title"> 时钟</div>
            </a>
            <a class="app" href="https://www.maemo.cc/Timer/">
                <div class="avater">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24">
                        <path fill="#000000"
                            d="M13.351 20.404a8.3 8.3 0 0 0 3.14-.616l2.69 2.694A11.9 11.9 0 0 1 13.352 24C6.73 24 1.36 18.627 1.36 12S6.73 0 13.351 0c2.097 0 4.065.54 5.78 1.487l-2.648 2.649a8.3 8.3 0 0 0-3.132-.613c-4.638 0-8.397 3.779-8.397 8.44c0 4.662 3.76 8.44 8.397 8.44m2.176-12.155l5.51-5.514l1.578 1.577l-5.51 5.514zm-2.233 5.635a1.956 1.956 0 0 1-1.952-1.961c0-1.083.874-1.961 1.952-1.961c1.079 0 1.952.878 1.952 1.96a1.956 1.956 0 0 1-1.952 1.962m9.347 5.695l-1.578 1.578l-5.51-5.514l1.577-1.578z" />
                    </svg>
                </div>
                <div class="title"> 盖泡面</div>
            </a>
            <a class="app" href="https://r.qq.com">
                <div class="avater"><svg t="1754554925255" class="icon" viewBox="0 0 1024 1024" version="1.1"
                        xmlns="http://www.w3.org/2000/svg" p-id="2280" width="48" height="48">
                        <path
                            d="M204.078 0h615.845q202.07 0 202.07 202.07v615.845q0 202.07-202.07 202.07H204.077q-202.07 0-202.07-202.07V202.069Q2.008 0 204.078 0z"
                            fill="#4496D3" p-id="2281"></path>
                        <path
                            d="M616.087 869.276a106.657 106.657 0 0 0-102.641 77.663 106.657 106.657 0 0 0-102.641-77.663H7.63A202.11 202.11 0 0 0 204.077 1024h615.846a202.11 202.11 0 0 0 196.447-154.724z m255.437-128.14c-44.654 44.172-99.026 54.934-157.816 35.217-19.356-6.506-35.258-8.032-52.204 3.212a73.326 73.326 0 0 1-11.324 3.775c15.46-26.865 4.015-43.65-9.036-62.685-28.993-42.285-23.09-96.738 11.405-136.051 56.22-64.251 166.731-64.251 223.112 0 40.96 46.662 40.076 112.64-4.137 156.531z"
                            fill="#FFFFFF" p-id="2282"></path>
                        <path
                            d="M818.96 611.187a20.078 20.078 0 0 0-20.883 19.276 19.516 19.516 0 0 0 18.473 21.444 20.078 20.078 0 0 0 22.006-18.03 20.68 20.68 0 0 0-19.597-22.69z m-108.906 0a20.078 20.078 0 0 0-20.079 22.207 19.556 19.556 0 0 0 21.404 18.472 20.078 20.078 0 0 0 19.275-20.921 20.922 20.922 0 0 0-20.6-19.758z"
                            fill="#4496D3" p-id="2283"></path>
                    </svg></div>
                <div class="title">微信读书</div>
            </a>
            <a class="app" href="javascript:void(0);" onclick="setting()">
                <div class="avater">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24">
                        <path fill="#000000"
                            d="m9.25 22l-.4-3.2q-.325-.125-.612-.3t-.563-.375L4.7 19.375l-2.75-4.75l2.575-1.95Q4.5 12.5 4.5 12.338v-.675q0-.163.025-.338L1.95 9.375l2.75-4.75l2.975 1.25q.275-.2.575-.375t.6-.3l.4-3.2h5.5l.4 3.2q.325.125.613.3t.562.375l2.975-1.25l2.75 4.75l-2.575 1.95q.025.175.025.338v.674q0 .163-.05.338l2.575 1.95l-2.75 4.75l-2.95-1.25q-.275.2-.575.375t-.6.3l-.4 3.2zm2.8-6.5q1.45 0 2.475-1.025T15.55 12t-1.025-2.475T12.05 8.5q-1.475 0-2.488 1.025T8.55 12t1.013 2.475T12.05 15.5" />
                    </svg>
                </div>
                <div class="title">设置</div>
            </a>
        </div>
    </main>
    <div class="mask" onclick="hideLog()"></div>
    <div class="log">
        <div class="log-header">
            <div class="log-title">标题</div>
            <div class="log-close" onclick="hideLog()">x</div>
        </div>
        <div class="log-content">请输入内容</div>
        <div class="log-body">
            <textarea name="" id="" placeholder="请输入欢迎语"></textarea>
            <div class="log-submit-container">
                <button class="log-submit" onclick="resetLog()">恢复默认欢迎语</button>
                <button class="log-submit" onclick="submitLog()">更改欢迎语</button>
            </div>
        </div>
        <div class="log-body">
            <button id="setLogo" class="log-submit" onclick="setLogo()">隐藏Logo</button>
        </div>

    </div>

</body>
<script>
    let config = {
        message: "如果说<br>书籍是人类进步的阶梯<br>那电纸书就是人类进步的电梯",
        logo: true
    }

    function init() {
        // 获取用户自定义配置
        let userConfig = localStorage.getItem('config');
        if (userConfig) {
            try {
                userConfig = JSON.parse(userConfig);
                config = { ...config, ...userConfig };
                document.querySelector('.message h1').innerHTML = config.message;
                if (!config.logo) {
                    document.querySelector('.header').style.display = 'none';
                    document.querySelector('#setLogo').innerHTML = '显示Logo';
                }
            } catch (e) {
                console.error('配置解析失败:', e);
            }
        } else {
            document.querySelector('.message h1').innerHTML = config.message;
        }
    }
    function setting() {
        showLog({ title: "设置", content: "欢迎使用墨枢！<br>在这里你可以自定义欢迎语和Logo的显示与隐藏。" });
    }

    function submitLog() {
        let log = document.querySelector('textarea').value;
        log = escapeHtml(log); // 先转义危险字符
        log = fixText(log); // 再替换换行
        if (log) {
            config.message = log;
            localStorage.setItem('config', JSON.stringify(config));
            document.querySelector('.message h1').innerHTML = log;
            hideLog();
        } else {
            showLog({ title: "提示" });
        }
    }

    function resetLog() {
        config.message = "如果说<br>书籍是人类进步的阶梯<br>那电纸书就是人类进步的电梯";
        localStorage.setItem('config', JSON.stringify(config));
        document.querySelector('.message h1').innerHTML = config.message;
        hideLog();
    }

    function fixText(text) {
        text = text || '';
        return text.replace(/\r?\n/g, "<br/>"); // 匹配 \n 或 \r\n，替换为 <br/>
    }

    function showLog({ title = "提示", content = "欢迎使用墨枢！<br>在这里你可以自定义欢迎语和Logo的显示与隐藏。" }) {
        document.querySelector('.mask').style.display = 'block';
        document.querySelector('.log').style.display = 'flex';
        document.querySelector('.log-content').innerHTML = content;
        document.querySelector('.log-title').innerHTML = title;

    }
    function hideLog() {
        document.querySelector('.mask').style.display = 'none';
        document.querySelector('.log').style.display = 'none';
    }
    function setLogo() {
        config.logo = !config.logo;
        localStorage.setItem('config', JSON.stringify(config));
        if (config.logo) {
            document.querySelector('.header').style.display = 'flex';
            document.querySelector('#setLogo').innerHTML = '隐藏Logo';
        } else {
            document.querySelector('.header').style.display = 'none';
            document.querySelector('#setLogo').innerHTML = '显示Logo';
        }
    }

    // 转义函数（转义除<br>外的HTML标签）
    function escapeHtml(unsafe) {
        return unsafe.replace(/[&<"'>]/g, function (match) {
            switch (match) {
                case '&': return '&amp;';
                case '<': return '&lt;';
                case '>': return '&gt;';
                case '"': return '&quot;';
                case "'": return '&#039;';
                default: return match;
            }
        });
    }
    init()
</script>

</html>